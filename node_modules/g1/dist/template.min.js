!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?t(exports):"function"==typeof define&&define.amd?define(["exports"],t):t((e=e||self).g1=e.g1||{})}(this,function(e){"use strict";var f="g1.template.render",c="g1.template.compiled",p="g1.template.prev_created";function s(e){return _.chain(e.data()).pickBy(function(e,t){return t.match(/^template/)}).mapKeys(function(e,t){return t.replace(/^template/,"").toLowerCase()}).value()}function l(a,r){var i=this,e=(r=r||{}).selector||i.data("selector")||'script[type="text/html"],template';return function(e,t){return e.filter(t).add(e.find(t))}(i,e).each(function(){var e=$(this);if("dispose"===a){var t=e.data(p);return t&&t.remove(),e.trigger({type:"template",templatedata:a,target:t})}var n=e.data(f);n?n(a,r):_.size(s(e))?function t(e,n,a,r){var i=_.pickBy(s(e),function(e){return!$(e).data(c)});return Promise.all(_.map(i,function(e){return t($(e),n,a,r)})).then(function(){return Promise.all(_.union(_.map(i,function(e){return o($(e),a,r)}),o(e,a,r)))}).catch(function(e){console.error(e)})}(e,i,a,r):o(e,a,r)}),this}function o(t,n,a){var r=t.html();t.is("script")||(r=_.unescape(r));var e=t.attr("src");if(e)return $.get(e).done(function(e){i(t,e,n,a)}).fail(function(e){n.xhr=e,i(t,r,n,a)});i(t,r,n,a)}function i(i,o,e,u){var d,t=_.template(o);function n(e,t){o=i.data(c)(e);var n=i.data("append")||(t?t.append:u.append),a=i.data("target")||(t?t.target:u.target),r=i.data("engine")||(t?t.engine:u.engine);return r&&"string"!=typeof r||(r=l.engines[r]||l.engines.default),n?(d=$($.parseHTML(o.trim())),a?$(a).append(d):i.before(d)):(d=r(i,a,o),i.data(p,d)),i.trigger({type:"template",templatedata:e,target:d}),d}return i.data(c,function(e){return e=_.extend({$node:i,$data:i.data()},_.mapValues(s(i),function(e){return $(e).data(c)}),e||{}),t(e)}),i.data(f,n),!1!==i.data("target")?n(e):null}(l.engines={}).default=l.engines.jquery=function(e,t,n){var a=$($.parseHTML(n.trim()));if(t)$(t).html(a);else{var r=e.data(p);r&&r.remove(),e.before(a)}return a},l.engines.vdom=function(e,t,n){var a,r,i;if(t=t||e.data(p)){var o=(a=$(t)).get(0);r="<"+o.nodeName,$.each(o.attributes,function(){r+=" "+this.name+"="+this.value}),r+=">",i="</"+o.nodeName+">"}else r="<div>",i="</div>",a=$(r+i).insertBefore(e);return a.each(function(){morphdom(this,r+n+i)}),a},"undefined"!=typeof jQuery&&jQuery.extend(jQuery.fn,{template:l}),e.version="0.17.3",Object.defineProperty(e,"__esModule",{value:!0})});
//# sourceMappingURL=template.min.js.map
