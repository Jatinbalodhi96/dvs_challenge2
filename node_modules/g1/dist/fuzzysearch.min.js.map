{"version":3,"file":"fuzzysearch.min.js","sources":["../src/fuzzysearch.js","../src/package.js"],"sourcesContent":["/*\n  var search = g1.fuzzysearch(data, options)\n  // Specify keys in data as a list of column names or functions\n  options.keys = [ 'col1', function(v) { return v.info.name } ]\n  // Specify max results to return. Default: 100\n  options.limit = 10\n  // Case sensitive search. Default: false\n  options.case = True\n*/\nexport function fuzzysearch (data, options) {\n  options = options || {}\n  // \"values\" is the string array with the text to search\n  var values\n  // If no options.keys are provided, use the raw data as-is\n  if (!options.keys)\n    values = data\n  // Else, join the provided keys\n  else\n    values = data.map(function(row) {\n      return options.keys.map(function(v) {\n        return typeof v == 'function' ? v(row) : row[v]\n      }).join(' ')\n    })\n  var limit = options.limit || 100\n  var flags = options.case ? '' : 'i'\n  // TODO: document these options once stabilized\n  var depth = options.depth || 10\n  var escape = options.escape || true\n\n  return function(text) {\n    var results = [],             // Final results\n        vals = values.slice(),    // Values to search. Crosses off matches to avoid duplication\n        re\n    // Trim the search text\n    text = text.replace(/^\\s/, '').replace(/\\s$/, '')\n    if (escape)\n      text = text.replace(/[-/\\\\^$*+?.()|[\\]{}]/g, '\\\\$&')\n\n    // 1. Match full phrase\n    re = new RegExp(text.replace(/\\s+/, '\\\\s+'), flags)\n    vals.forEach(function (v, i) {\n      if (v && re.test(v)) { results.push(data[i]); vals[i] = '' }\n    })\n    if (depth <= 1 || results.length >= limit) return results.slice(0, limit)\n\n    // 2. Match words in order\n    re = new RegExp(text.replace(/\\s+/, '.*'), flags)\n    vals.forEach(function (v, i) {\n      if (v && re.test(v)) { results.push(data[i]); vals[i] = '' }\n    })\n    if (depth <= 2 || results.length >= limit) return results.slice(0, limit)\n\n    // 3. Match words in any order\n    re = text.split(/\\s+/).map(function (word) { return new RegExp(word, flags) })\n    vals.forEach(function (v, i) {\n      if (v && re.every(function (word) { return word.test(v) })) { results.push(data[i]); vals[i] = '' }\n    })\n    if (depth <= 3 || results.length >= limit) return results.slice(0, limit)\n\n    // 4. Match partial words in any order\n    re = text.split(/\\s+/).map(function (word) { return new RegExp(word.replace(/(.)/g, '$&[\\\\S]*'), flags) })\n    vals.forEach(function (v, i) {\n      if (v && re.every(function (word) { return word.test(v) })) { results.push(data[i]); vals[i] = '' }\n    })\n\n    // 5. Match characters in order\n    re = new RegExp(text.replace(/(.)/g, '$&.*'), flags)\n    vals.forEach(function (v, i) {\n      if (v && re.test(v)) { results.push(data[i]); vals[i] = '' }\n    })\n    if (depth <= 4 || results.length >= limit) return results.slice(0, limit)\n\n    return results.slice(0, limit)\n  }\n}\n","export var name = \"g1\";\r\nexport var version = \"0.17.3\";\r\nexport var description = \"Gramex 1.x interaction library\";\r\nexport var license = \"MIT\";\r\nexport var author = \"S Anand <s.anand@gramener.com>\";\r\nexport var module = \"modules.js\";\r\nexport var main = \"dist/g1.js\";\r\nexport var jsdelivr = \"dist/g1.min.js\";\r\nexport var unpkg = \"dist/g1.min.js\";\r\nexport var repository = {\"type\":\"git\",\"url\":\"git@code.gramener.com:s.anand/g1.git\"};\r\nexport var scripts = {\"lint\":\"eslint index*.js src && eclint check '**/*.html' '**/*.js' '**/*.css' '**/*.yaml' '**/*.md'\",\"build\":\"rimraf dist && json2module package.json > src/package.js && rollup -c\",\"dev\":\"rimraf dist && json2module package.json > src/package.js && rollup -c -w\",\"pretest\":\"npm run lint && npm run build && browserify -s tape -r tape -o test/tape.js\",\"server\":\"npm run pretest && npm run lint && node test/server.js\",\"test\":\"tape test/test-*.js | faucet && node test/server.js puppeteer | tap-merge | faucet\",\"test-chrome\":\"node test/server.js chrome | tap-merge | faucet\",\"test-edge\":\"node test/server.js MicrosoftEdge | tap-merge | faucet\",\"test-firefox\":\"node test/server.js firefox | tap-merge | faucet\",\"prepublishOnly\":\"npm test\"};\r\nexport var devDependencies = {\"babel-core\":\"6\",\"babel-plugin-external-helpers\":\"6\",\"babel-plugin-transform-runtime\":\"6\",\"babel-preset-env\":\"1\",\"babel-preset-es2015\":\"6\",\"babelrc-rollup\":\"3\",\"bootstrap\":\"4.1\",\"bootstrap-select\":\"1.13\",\"browserify\":\"14\",\"component-emitter\":\"1\",\"d3\":\"4\",\"d3-scale-chromatic\":\"1\",\"deepmerge\":\"2\",\"eclint\":\"2\",\"es6-promise\":\"4\",\"eslint\":\"4\",\"events-polyfill\":\"2\",\"express\":\"4\",\"faucet\":\"0.0\",\"font-awesome\":\"4\",\"glob\":\"7.1\",\"html-minifier\":\"3\",\"is-plain-object\":\"2\",\"jquery\":\"3\",\"json2module\":\"0.0\",\"leaflet\":\"1.3\",\"lodash\":\"4\",\"moment\":\"2\",\"morphdom\":\"2\",\"numeral\":\"2\",\"popper.js\":\"1\",\"puppeteer\":\"0.13\",\"regenerator-runtime\":\"0.11\",\"rimraf\":\"2\",\"rollup\":\"1\",\"rollup-plugin-babel\":\"3\",\"rollup-plugin-commonjs\":\"10\",\"rollup-plugin-node-resolve\":\"5\",\"rollup-plugin-uglify\":\"6\",\"rollup-pluginutils\":\"2\",\"selenium-webdriver\":\"3\",\"tap-merge\":\"0.3\",\"tape\":\"4\",\"topojson\":\"3\",\"unfetch\":\"3\"};\r\nexport var dependencies = {\"d3-array\":\"2\",\"lodash-es\":\"4\"};\r\n"],"names":["data","options","values","keys","map","row","v","join","limit","flags","case","depth","escape","text","re","results","vals","slice","replace","RegExp","forEach","i","test","push","length","split","word","every"],"mappings":"mNASO,SAAsBA,EAAMC,GAGjC,IAAIC,EAMFA,GARFD,EAAUA,GAAW,IAIRE,KAIFH,EAAKI,IAAI,SAASC,GACzB,OAAOJ,EAAQE,KAAKC,IAAI,SAASE,GAC/B,MAAmB,mBAALA,EAAkBA,EAAED,GAAOA,EAAIC,KAC5CC,KAAK,OANDP,EAQX,IAAIQ,EAAQP,EAAQO,OAAS,IACzBC,EAAQR,EAAQS,KAAO,GAAK,IAE5BC,EAAQV,EAAQU,OAAS,GACzBC,EAASX,EAAQW,SAAU,EAE/B,OAAO,SAASC,GACd,IAEIC,EAFAC,EAAU,GACVC,EAAOd,EAAOe,QAYlB,OATAJ,EAAOA,EAAKK,QAAQ,MAAO,IAAIA,QAAQ,MAAO,IAC1CN,IACFC,EAAOA,EAAKK,QAAQ,wBAAyB,SAG/CJ,EAAK,IAAIK,OAAON,EAAKK,QAAQ,MAAO,QAAST,GAC7CO,EAAKI,QAAQ,SAAUd,EAAGe,GACpBf,GAAKQ,EAAGQ,KAAKhB,KAAMS,EAAQQ,KAAKvB,EAAKqB,IAAKL,EAAKK,GAAK,MAEtDV,GAAS,GAAKI,EAAQS,QAAUhB,EAAcO,EAAQE,MAAM,EAAGT,IAGnEM,EAAK,IAAIK,OAAON,EAAKK,QAAQ,MAAO,MAAOT,GAC3CO,EAAKI,QAAQ,SAAUd,EAAGe,GACpBf,GAAKQ,EAAGQ,KAAKhB,KAAMS,EAAQQ,KAAKvB,EAAKqB,IAAKL,EAAKK,GAAK,MAEtDV,GAAS,GAAKI,EAAQS,QAAUhB,EAAcO,EAAQE,MAAM,EAAGT,IAGnEM,EAAKD,EAAKY,MAAM,OAAOrB,IAAI,SAAUsB,GAAQ,OAAO,IAAIP,OAAOO,EAAMjB,KACrEO,EAAKI,QAAQ,SAAUd,EAAGe,GACpBf,GAAKQ,EAAGa,MAAM,SAAUD,GAAQ,OAAOA,EAAKJ,KAAKhB,OAASS,EAAQQ,KAAKvB,EAAKqB,IAAKL,EAAKK,GAAK,MAE7FV,GAAS,GAAKI,EAAQS,QAAUhB,IAGpCM,EAAKD,EAAKY,MAAM,OAAOrB,IAAI,SAAUsB,GAAQ,OAAO,IAAIP,OAAOO,EAAKR,QAAQ,OAAQ,YAAaT,KACjGO,EAAKI,QAAQ,SAAUd,EAAGe,GACpBf,GAAKQ,EAAGa,MAAM,SAAUD,GAAQ,OAAOA,EAAKJ,KAAKhB,OAASS,EAAQQ,KAAKvB,EAAKqB,IAAKL,EAAKK,GAAK,MAIjGP,EAAK,IAAIK,OAAON,EAAKK,QAAQ,OAAQ,QAAST,GAC9CO,EAAKI,QAAQ,SAAUd,EAAGe,GACpBf,GAAKQ,EAAGQ,KAAKhB,KAAMS,EAAQQ,KAAKvB,EAAKqB,IAAKL,EAAKK,GAAK,MAEtDV,GAAS,GAAKI,EAAQS,QAbwBT,EAAQE,MAAM,EAAGT,iBCxDlD"}