{"version":3,"file":"ajax.min.js","sources":["../src/ajaxchain.js","../index-ajax.js","../src/package.js"],"sourcesContent":["export function ajaxchain(request, $self, requests, responses) {\n  $self = $self || $('<div>')\n  requests = requests || []\n  responses = responses || []\n  if (!('limit' in request))\n    request.limit = 10\n  request.limit--\n  $.ajax(request)\n    .done(function (response, status, xhr) {\n      requests.push(request)\n      responses.push(response)\n      $self.trigger({ type: 'load', request: request, response: response, xhr: xhr })\n      if (request.chain && request.limit > 0) {\n        try {\n          var updates = request.chain(response, request, xhr)\n        } catch (e) {\n          $self.trigger({ type: 'error', request: request, xhr: xhr, exception: e })\n          // eslint-disable-next-line no-console\n          console.warn('$.ajaxchain: chain() exception', e)\n        }\n        if ($.isPlainObject(updates) && !$.isEmptyObject(updates)) {\n          var new_request = $.extend(true, {}, request, updates)\n          var next = ajaxchain(new_request, $self, requests, responses)\n        }\n      }\n      if (!next)\n        $self.trigger({ type: 'done', request: requests, response: responses })\n    })\n    .fail(function (xhr, testStatus, error) {\n      $self.trigger({ type: 'error', request: request, xhr: xhr })\n      $self.trigger({ type: 'done', request: requests, response: responses })\n      // eslint-disable-next-line no-console\n      console.warn('$.ajaxchain: ajax error', error)\n    })\n  return $self\n}\n\n// Chain through a list of URLs in order\najaxchain.list = function (urls) {\n  return function (response, request) {\n    var next = urls.indexOf(request.url) + 1\n    if (next < urls.length)\n      return { url: urls[next] }\n  }\n}\n\n// Used by Twitter, YouTube\n// Google:    .cursor('data.pageToken', 'nextPageToken')\n// Twitter:   .cursor('data.cursor', 'next_cursor')\n// Facebook:  .cursor('url', 'paging.next')\nif (typeof _ == 'undefined')\n  ajaxchain.cursor = function () {\n    throw new Error('ajaxchain.cursor requires lodash')\n  }\nelse\n  ajaxchain.cursor = function (target, source) {\n    return function (response) {\n      var key = _.get(response, source)\n      if (key)\n        return _.set({}, target, key)\n    }\n  }\n","export { version } from './src/package.js'\nimport { ajaxchain } from './src/ajaxchain.js'\n\nif (typeof jQuery != 'undefined') {\n  jQuery.extend(jQuery, {\n    ajaxchain: ajaxchain\n  })\n}\n","export var name = \"g1\";\r\nexport var version = \"0.17.3\";\r\nexport var description = \"Gramex 1.x interaction library\";\r\nexport var license = \"MIT\";\r\nexport var author = \"S Anand <s.anand@gramener.com>\";\r\nexport var module = \"modules.js\";\r\nexport var main = \"dist/g1.js\";\r\nexport var jsdelivr = \"dist/g1.min.js\";\r\nexport var unpkg = \"dist/g1.min.js\";\r\nexport var repository = {\"type\":\"git\",\"url\":\"git@code.gramener.com:s.anand/g1.git\"};\r\nexport var scripts = {\"lint\":\"eslint index*.js src && eclint check '**/*.html' '**/*.js' '**/*.css' '**/*.yaml' '**/*.md'\",\"build\":\"rimraf dist && json2module package.json > src/package.js && rollup -c\",\"dev\":\"rimraf dist && json2module package.json > src/package.js && rollup -c -w\",\"pretest\":\"npm run lint && npm run build && browserify -s tape -r tape -o test/tape.js\",\"server\":\"npm run pretest && npm run lint && node test/server.js\",\"test\":\"tape test/test-*.js | faucet && node test/server.js puppeteer | tap-merge | faucet\",\"test-chrome\":\"node test/server.js chrome | tap-merge | faucet\",\"test-edge\":\"node test/server.js MicrosoftEdge | tap-merge | faucet\",\"test-firefox\":\"node test/server.js firefox | tap-merge | faucet\",\"prepublishOnly\":\"npm test\"};\r\nexport var devDependencies = {\"babel-core\":\"6\",\"babel-plugin-external-helpers\":\"6\",\"babel-plugin-transform-runtime\":\"6\",\"babel-preset-env\":\"1\",\"babel-preset-es2015\":\"6\",\"babelrc-rollup\":\"3\",\"bootstrap\":\"4.1\",\"bootstrap-select\":\"1.13\",\"browserify\":\"14\",\"component-emitter\":\"1\",\"d3\":\"4\",\"d3-scale-chromatic\":\"1\",\"deepmerge\":\"2\",\"eclint\":\"2\",\"es6-promise\":\"4\",\"eslint\":\"4\",\"events-polyfill\":\"2\",\"express\":\"4\",\"faucet\":\"0.0\",\"font-awesome\":\"4\",\"glob\":\"7.1\",\"html-minifier\":\"3\",\"is-plain-object\":\"2\",\"jquery\":\"3\",\"json2module\":\"0.0\",\"leaflet\":\"1.3\",\"lodash\":\"4\",\"moment\":\"2\",\"morphdom\":\"2\",\"numeral\":\"2\",\"popper.js\":\"1\",\"puppeteer\":\"0.13\",\"regenerator-runtime\":\"0.11\",\"rimraf\":\"2\",\"rollup\":\"1\",\"rollup-plugin-babel\":\"3\",\"rollup-plugin-commonjs\":\"10\",\"rollup-plugin-node-resolve\":\"5\",\"rollup-plugin-uglify\":\"6\",\"rollup-pluginutils\":\"2\",\"selenium-webdriver\":\"3\",\"tap-merge\":\"0.3\",\"tape\":\"4\",\"topojson\":\"3\",\"unfetch\":\"3\"};\r\nexport var dependencies = {\"d3-array\":\"2\",\"lodash-es\":\"4\"};\r\n"],"names":["ajaxchain","request","$self","requests","responses","$","limit","ajax","done","response","status","xhr","push","trigger","type","chain","updates","e","exception","console","warn","isPlainObject","isEmptyObject","next","extend","fail","testStatus","error","list","urls","indexOf","url","length","cursor","_","Error","target","source","key","get","set","jQuery"],"mappings":"qMAAO,SAASA,EAAUC,EAASC,EAAOC,EAAUC,GAkClD,OAjCAF,EAAQA,GAASG,EAAE,SACnBF,EAAWA,GAAY,GACvBC,EAAYA,GAAa,GACnB,UAAWH,IACfA,EAAQK,MAAQ,IAClBL,EAAQK,QACRD,EAAEE,KAAKN,GACJO,KAAK,SAAUC,EAAUC,EAAQC,GAIhC,GAHAR,EAASS,KAAKX,GACdG,EAAUQ,KAAKH,GACfP,EAAMW,QAAQ,CAAEC,KAAM,OAAQb,QAASA,EAASQ,SAAUA,EAAUE,IAAKA,IACrEV,EAAQc,OAAyB,EAAhBd,EAAQK,MAAW,CACtC,IACE,IAAIU,EAAUf,EAAQc,MAAMN,EAAUR,EAASU,GAC/C,MAAOM,GACPf,EAAMW,QAAQ,CAAEC,KAAM,QAASb,QAASA,EAASU,IAAKA,EAAKO,UAAWD,IAEtEE,QAAQC,KAAK,iCAAkCH,GAEjD,GAAIZ,EAAEgB,cAAcL,KAAaX,EAAEiB,cAAcN,GAC/C,IACIO,EAAOvB,EADOK,EAAEmB,QAAO,EAAM,GAAIvB,EAASe,GACZd,EAAOC,EAAUC,GAGlDmB,GACHrB,EAAMW,QAAQ,CAAEC,KAAM,OAAQb,QAASE,EAAUM,SAAUL,MAE9DqB,KAAK,SAAUd,EAAKe,EAAYC,GAC/BzB,EAAMW,QAAQ,CAAEC,KAAM,QAASb,QAASA,EAASU,IAAKA,IACtDT,EAAMW,QAAQ,CAAEC,KAAM,OAAQb,QAASE,EAAUM,SAAUL,IAE3De,QAAQC,KAAK,0BAA2BO,KAErCzB,EAITF,EAAU4B,KAAO,SAAUC,GACzB,OAAO,SAAUpB,EAAUR,GACzB,IAAIsB,EAAOM,EAAKC,QAAQ7B,EAAQ8B,KAAO,EACvC,GAAIR,EAAOM,EAAKG,OACd,MAAO,CAAED,IAAKF,EAAKN,MASvBvB,EAAUiC,OADI,oBAALC,EACU,WACjB,MAAM,IAAIC,MAAM,qCAGC,SAAUC,EAAQC,GACnC,OAAO,SAAU5B,GACf,IAAI6B,EAAMJ,EAAEK,IAAI9B,EAAU4B,GAC1B,GAAIC,EACF,OAAOJ,EAAEM,IAAI,GAAIJ,EAAQE,KCxDZ,oBAAVG,QACTA,OAAOjB,OAAOiB,OAAQ,CACpBzC,UAAWA,cCJM"}